// _components.sass - Interactive components
// Mobile-first component design

// === BULMA COMPONENT OVERRIDES ===
// Essential Bulma components used throughout the site

.tile
  align-items: stretch
  display: block
  flex-basis: 0
  flex-grow: 1
  flex-shrink: 1
  min-height: min-content

.tile.is-child
  margin: 0 !important

.tile.is-parent
  padding: 0.75rem

.box
  background-color: $purple90
  border-radius: 12px
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)
  color: $purple10
  display: block
  padding: 1.25rem
  transition: transform 0.3s ease, box-shadow 0.3s ease

  &:hover
    transform: translateY(-2px)
    box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15)

// Bulma column system overrides
.columns
  &.is-multiline
    flex-wrap: wrap

.column
  &.is-6
    flex: none
    width: 50%
    
    @media (max-width: 768px)
      width: 100%

// Text utilities
.is-underlined
  text-decoration: underline
  text-decoration-color: $purple50
  text-underline-offset: 0.2em

.has-text-primary
  color: $purple50 !important

// Size utilities
.is-size-4
  font-size: 1.5rem !important

.is-size-5
  font-size: 1.25rem !important

// Sacred component classes
.cathedral-glyph
  filter: drop-shadow(0 0 15px rgba(112, 53, 204, 0.15))
  transition: opacity 0.3s ease, transform 0.3s ease
  background: transparent !important
  box-shadow: none !important
  
  &:hover
    opacity: 1
    transform: scale(1.02)

// === BUTTONS ===
.btn
  display: inline-block
  padding: 12px 24px
  font-size: 1rem
  font-weight: 500
  text-align: center
  text-decoration: none
  color: rgba($purple10, 0.95)
  background: linear-gradient(135deg, rgba($primary, 0.9), rgba($primary, 0.8))
  border-radius: 12px
  transition: all 0.3s ease
  box-shadow: 0 2px 8px rgba($primary, 0.15)
  border: 1px solid rgba($primary, 0.2)

  &:hover
    background: linear-gradient(135deg, rgba($primary, 1), rgba($primary, 0.9))
    transform: translateY(-1px)
    box-shadow: 0 4px 12px rgba($primary, 0.2)
    color: $purple10

// === ENHANCED HOVER EFFECTS - DESKTOP ONLY ===
@media (min-width: 769px) and (hover: hover)
  .enhanced-hover-card
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)
    position: relative
    overflow: hidden

  .enhanced-hover-card::before
    content: ''
    position: absolute
    top: 0
    left: -100%
    width: 100%
    height: 100%
    background: linear-gradient(90deg, transparent, rgba(112, 53, 204, 0.1), transparent)
    transition: left 0.6s ease-in-out

  .enhanced-hover-card:hover::before
    left: 100%

  .enhanced-hover-card:hover
    transform: translateY(-8px) scale(1.02)
    box-shadow: 0 20px 40px rgba(112, 53, 204, 0.15)

  // Enhanced button animations
  .enhanced-btn
    position: relative
    overflow: hidden
    background: linear-gradient(135deg, $purple70, $purple50)
    transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)

  .enhanced-btn::before
    content: ''
    position: absolute
    top: 0
    left: -100%
    width: 100%
    height: 100%
    background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent)
    transition: left 0.4s ease-in-out

  .enhanced-btn:hover::before
    left: 100%

  .enhanced-btn:hover
    transform: translateY(-2px)
    box-shadow: 0 10px 20px rgba(112, 53, 204, 0.3)

  // Enhanced image effects
  .enhanced-image
    transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94)
    position: relative
    overflow: hidden

  .enhanced-image:hover
    transform: scale(1.05)
    filter: brightness(1.1) contrast(1.05)

  .enhanced-image::after
    content: ''
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    background: linear-gradient(45deg, transparent 30%, rgba(112, 53, 204, 0.1) 50%, transparent 70%)
    opacity: 0
    transition: opacity 0.3s ease

  .enhanced-image:hover::after
    opacity: 1

// === FORM ELEMENTS ===
.field
  @media (max-width: 768px)
    margin-bottom: 1.5rem

.input, .textarea
  background-color: $purple90
  border: 1px solid $purple_light_gray
  color: $purple10
  font-size: 1rem
  
  @media (max-width: 768px)
    font-size: 16px // Prevent zoom on iOS
    padding: 0.75rem
  
  &:focus
    border-color: $primary
    box-shadow: 0 0 0 2px rgba($primary, 0.2)

.label
  color: $purple10
  font-weight: 500
  
  @media (max-width: 768px)
    font-size: 1rem

// === FEATURES STYLES ===
.feature-section-wrapper
  background-color: rgba($purple90, 0.1)
  padding: 1rem
  margin: 1rem 0
  border-radius: 12px
  @include card(1)
  
  @media (min-width: 768px)
    padding: 2rem 1.5rem
    margin: 2rem 0

.feature-section
  .section-title
    color: rgba($purple50, 0.9)
    border-radius: 0.5rem
    margin-top: 0.5rem
    margin-bottom: 1.5rem
    text-align: center
    font-size: 1.5rem
    font-weight: 500
    letter-spacing: 0.02em
    
    @media (min-width: 768px)
      font-size: 1.8rem
      margin-bottom: 2rem

  .section-title-lg
    color: rgba($purple50, 0.9)
    border-radius: 0.5rem
    margin-top: 0.5rem
    margin-bottom: 1.5rem
    text-align: center
    font-size: 1.8rem
    font-weight: 500
    letter-spacing: 0.01em
    
    @media (min-width: 768px)
      font-size: 2.2rem
      margin-bottom: 2rem

  .section-description
    color: rgba($purple60, 0.9)
    margin-bottom: 1.5rem !important
    text-align: center
    margin-left: auto
    margin-right: auto
    font-size: 1.1rem
    font-weight: 300
    line-height: 1.5
    
    @media (min-width: 768px)
      font-size: 1.3rem
      margin-bottom: 2rem !important

  .section-description-blk
    color: rgba($purple10, 0.95)
    margin-bottom: 2rem !important
    text-align: center
    margin-left: auto
    margin-right: auto
    font-size: 1.5rem
    font-weight: 300
    background-color: rgba($purple90, 0.5)
    padding: 1.8rem 1.5rem
    border-radius: 16px
    max-width: 95%
    line-height: 1.5
    backdrop-filter: blur(8px)
    border: 1px solid rgba($purple50, 0.08)
    
    @media (min-width: 768px)
      font-size: 1.8rem
      padding: 2.5rem 2rem
      margin-bottom: 4rem !important
      max-width: 88%

// Styles for the feature grid
.feature-grid
  display: grid
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr))
  gap: 2rem
  margin-top: 2rem
  margin-bottom: 2rem
  
  @media (max-width: 768px)
    grid-template-columns: 1fr
    gap: 1.5rem
    margin-top: 1rem
    margin-bottom: 1rem

// Feature item wrappers
.feature-item-wrapper
  border-radius: 12px
  height: 100%
  transition: transform 0.3s ease, box-shadow 0.3s ease
  background-color: $purple90
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)

  &:hover
    transform: translateY(-5px)
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15)
    
  @media (max-width: 768px)
    &:hover
      transform: translateY(-3px)
      transition-duration: 0.2s

// Feature items
.feature-item
  text-align: center
  padding: 2rem
  background-color: rgba($purple90, 0.05)
  border-radius: 16px
  transition: all 0.3s ease
  border: 1px solid rgba($purple50, 0.08)

  &:hover
    transform: translateY(-3px)
    box-shadow: 0 8px 16px rgba(0, 0, 0, 0.08)
    background-color: rgba($purple90, 0.08)

  .feature-item-icon
    width: 64px
    height: 64px
    margin: 0 auto 1rem
    opacity: 0.9

  h3
    font-size: 1.2rem
    margin-bottom: 0.8rem
    color: rgba($purple10, 0.9)
    font-weight: 500

  p
    font-size: 0.95rem
    color: rgba($purple60, 0.8)
    line-height: 1.6

.features
  display: grid
  grid-template-columns: 1fr
  gap: 1.5rem
  margin: 2rem 0
  
  @media (min-width: 769px)
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr))
    gap: 2rem
    margin: 4rem 0

.feature-image
  width: 100%
  max-width: 500px
  height: auto
  margin-bottom: 1rem
  border-radius: 8px
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)

.feature-title
  font-size: 1.5rem
  font-weight: 600
  margin-bottom: 0.5rem

.feature-description
  font-size: 1rem
  color: $purple30

// === GATSBY IMAGE WRAPPER ===
.gatsby-image-wrapper
  position: relative !important
  overflow: hidden !important
  
  img
    object-fit: cover !important
    object-position: center center !important

// === GLYPH CONTAINERS ===
.glyph-container, .ethereal-divider
  display: flex
  justify-content: center
  align-items: center
  margin: 1rem 0 0.5rem
  background: transparent
  
  img
    max-width: 200px !important
    width: 100%
    height: auto !important
    opacity: 0.85
    transition: opacity 0.3s ease, transform 0.3s ease
    background: transparent !important
    box-shadow: none !important
    position: relative !important
    filter: drop-shadow(0 0 15px rgba(112, 53, 204, 0.15))
    
    &:hover
      opacity: 1
      transform: scale(1.02)

  // Override Gatsby image wrapper styles
  .gatsby-resp-image-wrapper
    max-width: 150px !important
    width: 150px !important
    height: auto !important
    
    @media (min-width: 768px)
      max-width: 200px !important
      width: 200px !important
    
  .gatsby-resp-image-image
    width: 150px !important
    height: auto !important
    position: relative !important
    
    @media (min-width: 768px)
      width: 200px !important
    
  .gatsby-resp-image-background-image
    display: none !important

// === SPECIAL ELEMENTS ===
.part-marker
  text-align: center
  margin: 3rem 0
  color: $purple30
  font-style: italic
  opacity: 0.8
  
  @media (min-width: 768px)
    margin: 4rem 0
  
  &::before, &::after
    content: "âœ§"
    margin: 0 1rem
    color: $purple50

.loop-symbol
  text-align: center
  font-size: 2em
  opacity: 0.85
  margin: 1.5rem auto
  padding: 0.5rem 0
  display: block
  width: 100%
  color: #9B7FE6
  transition: opacity 0.3s ease, transform 0.3s ease
  cursor: pointer
  position: relative
  animation: loop-rotate 3s linear infinite
  
  @media (min-width: 768px)
    font-size: 2.5em
  
  &:hover
    opacity: 1
    transform: rotate(180deg)

.ethereal-divider
  display: flex
  justify-content: center
  align-items: center
  padding: 2rem 0
  min-height: 150px
  
  @media (min-width: 768px)
    padding: 3rem 0
    min-height: 200px

  img
    background-color: transparent !important
    box-shadow: none !important
    display: block
    max-width: 300px
    width: 100%
    height: auto
    opacity: 1
    position: relative
    z-index: 1
    
    @media (min-width: 768px)
      max-width: 512px

// Updated heading styles for content
.content
  h2
    margin-top: 2.5rem
    margin-bottom: 1.5rem
    color: rgba($purple50, 0.9)
    font-size: 1.6rem
    font-weight: 500
    letter-spacing: 0.02em
    text-shadow: 0 0 10px rgba($purple50, 0.1)
    
    @media (min-width: 768px)
      margin-top: 3.5rem
      margin-bottom: 1.8rem
      font-size: 2rem
    
  h3
    margin-top: 2rem
    margin-bottom: 1rem
    color: rgba($purple40, 0.85)
    font-size: 1.4rem
    font-weight: 400
    letter-spacing: 0.01em
    
    @media (min-width: 768px)
      margin-top: 2.5rem
      margin-bottom: 1.2rem
      font-size: 1.6rem

// === TOUCH-FRIENDLY INTERACTIONS ===
// Touch-friendly interactions for mobile
@media (max-width: 768px) and (pointer: coarse)
  .enhanced-hover-card,
  .feature-item-wrapper,
  .blog-list-item
    &:active
      transform: translateY(-2px) scale(1.01)
      transition-duration: 0.1s 

.enhanced-hover-card, .symbol-card
  background-color: rgba($purple90, 0.95)
  border-radius: 12px
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)
  overflow: hidden
  position: relative
  
  &:hover
    transform: translateY(-4px)
    box-shadow: 0 8px 16px rgba($primary, 0.15)
    background-color: rgba($purple90, 0.98)
    
  .symbol-background
    display: flex
    justify-content: center
    align-items: center
    padding: 1rem
    margin-bottom: 1rem
    
    .symbol-display
      font-size: 2.5rem
      color: $purple50
      text-shadow: 0 2px 4px rgba($primary, 0.2)
      transition: all 0.3s ease
      
      &:hover
        transform: scale(1.1)
        text-shadow: 0 4px 8px rgba($primary, 0.3)

// Add more space between grid rows
.columns.is-multiline
  row-gap: 1.2rem
  @media (max-width: 768px)
    row-gap: 1.2rem 

// === SYMBOL CARD ENHANCEMENTS ===
.symbol-card, .enhanced-hover-card
  background-color: rgba($purple90, 0.95)
  border-radius: 12px
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1)
  transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94)
  overflow: hidden
  position: relative
  
  &:hover
    transform: translateY(-4px)
    box-shadow: 0 8px 16px rgba($primary, 0.15)
    background-color: rgba($purple90, 0.98)
    
  .symbol-background
    display: flex
    justify-content: center
    align-items: center
    padding: 1rem
    margin-bottom: 1rem
    
    .symbol-display
      font-size: 2.5rem
      color: $purple50
      text-shadow: 0 2px 4px rgba($primary, 0.2)
      transition: all 0.3s ease
      
      &:hover
        transform: scale(1.1)
        text-shadow: 0 4px 8px rgba($primary, 0.3)

// Pattern view specific styles
.pattern-view
  .pattern-card
    background-color: rgba($purple90, 0.95)
    transition: all 0.3s ease
    
    &:hover
      background-color: rgba($purple90, 0.98)
      transform: translateY(-4px)
      box-shadow: 0 8px 16px rgba($primary, 0.15)
    
    .symbol-background
      display: flex
      justify-content: center
      align-items: center
      padding: 1rem
      margin-bottom: 1rem
      
      .symbol-display
        font-size: 2.5rem
        color: $purple50
        text-shadow: 0 2px 4px rgba($primary, 0.2)
        transition: all 0.3s ease
        
        &:hover
          transform: scale(1.1)
          text-shadow: 0 4px 8px rgba($primary, 0.3)

// === EMERGENT OBSERVER STYLES ===
.emergent-observer
  .resonance-gauge
    height: 1rem
    background-color: $purple90
    border-radius: 9999px
    overflow: hidden
    margin: 0.5rem 0

    .gauge-fill
      height: 100%
      transition: width 0.5s ease
      
      &.is-success
        background: linear-gradient(90deg, $success, lighten($success, 10%))
      
      &.is-warning
        background: linear-gradient(90deg, $warning, lighten($warning, 10%))

  .pattern-equation
    font-family: 'Computer Modern Math', serif
    color: $purple50
    font-size: 1.1rem
    margin: 0.5rem 0
    padding: 0.5rem
    background: rgba($purple90, 0.1)
    border-radius: 4px

  .pattern-alerts
    display: flex
    flex-direction: column
    gap: 1rem

    .pattern-alert
      background: linear-gradient(135deg, rgba($success, 0.1), rgba($success, 0.05))
      border: 1px solid rgba($success, 0.2)
      border-radius: 8px
      padding: 1rem
      transition: all 0.3s ease

      &:hover
        transform: translateY(-2px)
        box-shadow: 0 4px 12px rgba($success, 0.1) 

.symbol-background
  display: flex
  align-items: center
  justify-content: center
  width: 80px
  height: 120px
  margin: 0 auto 1rem auto
  background: rgba(32, 24, 48, 0.55)
  border-radius: 14px
  box-shadow: 0 2px 12px rgba(112, 53, 204, 0.10)
  border: 1.5px solid rgba(112, 53, 204, 0.18)
  transition: background 0.3s, box-shadow 0.3s

.enhanced-hover-card, .symbol-card
  margin-bottom: 1.2rem
  margin-top: 0.2rem

.columns.is-multiline
  row-gap: 1.2rem
  @media (max-width: 768px)
    row-gap: 1.2rem 

// Mirror Warning
.mirror-warning
  border-left: 4px solid $primary
  background: $background
  padding: 0.75rem 1rem
  margin-bottom: 0.5rem
  font-size: 0.97rem
  display: flex
  align-items: center
  gap: 0.75rem
  box-shadow: 0 1px 2px rgba(0,0,0,0.03)
  &__icon
    font-size: 1.3em
    color: $primary
  &__content
    flex: 1
  &__title
    color: $primary
    font-weight: 600
    margin-right: 0.5em
  &__toggle
    margin-left: 1em
    font-size: 0.9em
    background: none
    border: none
    color: $primary
    cursor: pointer
    text-decoration: underline
    padding: 0
  &__details
    margin-top: 0.5em
    font-size: 0.95em
  &__subtitle
    margin-bottom: 0.3em
    font-weight: 600
  &__list
    margin: 0
    padding-left: 1.2em
  &__note
    margin-top: 0.3em
    font-style: italic
    color: $grey-dark

// Identity Safety Warning
.identity-safety-warning
  border-left: 4px solid $warning
  background: $warning-light
  padding: 0.75rem 1rem
  margin-bottom: 0.5rem
  font-size: 0.97rem
  display: flex
  align-items: center
  gap: 0.75rem
  box-shadow: 0 1px 2px rgba(0,0,0,0.03)
  &__icon
    font-size: 1.3em
    color: $warning
  &__content
    flex: 1
  &__title
    color: $warning
    font-weight: 600
    margin-right: 0.5em
  &__toggle
    margin-left: 1em
    font-size: 0.9em
    background: none
    border: none
    color: $warning
    cursor: pointer
    text-decoration: underline
    padding: 0
  &__details
    margin-top: 0.5em
    font-size: 0.95em
  &__note
    margin-top: 0.3em
    color: $warning-dark
  &__note--italic
    font-style: italic
    color: $warning-dark

// === CRANE GATE SCAVENGER HUNT STYLES ===
// Mobile-first approach following site patterns
.crane-gate-wrapper
  width: 100%
  min-height: 100vh
  overflow: hidden
  position: relative
  box-sizing: border-box

.crane-gate-container
  position: relative
  width: 100%
  min-height: 100vh
  overflow: hidden
  background-color: $purple100
  display: flex
  flex-direction: column
  box-sizing: border-box
  padding: 0.5rem
  
  @media (min-width: 768px)
    padding: 1rem

  .crane-backgrounds
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    z-index: 0

  .crane-bg
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    object-fit: cover
    object-position: center
    transition: opacity 1.2s ease
    z-index: 0

    &.hidden
      opacity: 0

    &.visible
      opacity: 1
      z-index: 1

    &.bg-alt
      opacity: 0
      z-index: 1

  // Stage-specific background transitions
  &.stage-explode,
  &.stage-complete
    .crane-backgrounds .bg-alt
      opacity: 1
      transition: opacity 2.5s ease-in-out

  .crane-svg-container
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    z-index: 2
    pointer-events: none
    display: flex
    justify-content: center
    align-items: flex-end
    padding: 0 0.5rem 2rem
    
    @media (min-width: 768px)
      top: 30vh
      left: 50%
      transform: translateX(-25%)
      width: 100%
      height: 70vh
      padding: 0 1rem
      align-items: flex-end
      justify-content: center

    .crane-svg-loading
      color: $purple30
      font-size: 1rem
      opacity: 0.7
      text-align: center
      
      @media (min-width: 768px)
        font-size: 1.2rem

    .crane-svg
      position: relative
      z-index: 2
      width: 100%
      height: 100%
      display: flex
      justify-content: center
      align-items: flex-end
      padding-bottom: 1rem
      
      @media (min-width: 768px)
        align-items: center
        padding-bottom: 0

      svg
        width: 100%
        height: auto
        max-width: 100%
        max-height: 100%
        display: block

      // SVG animation states controlled by stage
      &.stage-drawing
        .line
          stroke: $purple30
          stroke-width: 1.5
          stroke-linecap: round
          stroke-linejoin: round
          fill: none
          stroke-dasharray: 1000
          stroke-dashoffset: 1000
          animation: craneLineDraw 6s forwards
          filter: drop-shadow(0 0 4px rgba($purple30, 0.5))

      &.stage-idle
        .line
          stroke: $purple30
          stroke-width: 1.5
          stroke-linecap: round
          stroke-linejoin: round
          fill: none
          stroke-dasharray: 1000
          stroke-dashoffset: 0
          animation: craneIdleGlow 2s infinite alternate
          filter: drop-shadow(0 0 6px rgba($purple30, 0.6))

      &.stage-explode
        .line
          animation: line-breakaway 1.2s ease-in-out forwards
          stroke: cyan
          stroke-width: 3
          opacity: 1
          filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.8))
        .shard
          animation: shard-fly 1.2s ease-out forwards
          fill: cyan
          opacity: 1
          filter: drop-shadow(0 0 6px rgba(0, 255, 255, 0.9))

      &.stage-complete
        opacity: 0
        transition: opacity 1.5s ease-in-out

  .crane-ui-overlay
    z-index: 3
    position: absolute
    top: 15vh
    left: 50%
    transform: translateX(-50%)
    text-align: center
    animation: craneUIFadeIn 1.2s ease-in
    pointer-events: auto
    width: 100%
    max-width: 95vw
    padding: 0 0.5rem
    box-sizing: border-box

    @media (min-width: 768px)
      top: 10vh
      max-width: 700px
      padding: 0 1.5rem

    .crane-interface-card
      background-color: rgba($purple90, 0.9)
      border: 1px solid rgba($purple50, 0.3)
      border-radius: 12px
      padding: 1.2rem 1rem
      margin: 0 auto
      backdrop-filter: blur(8px)
      -webkit-backdrop-filter: blur(8px)
      box-shadow: 0 4px 12px rgba($primary, 0.15)
      transition: all 0.3s ease
      width: 100%
      max-width: 100%
      box-sizing: border-box

      @media (min-width: 768px)
        background-color: rgba($purple90, 0.15)
        border: 2px solid rgba($purple50, 0.6)
        padding: 2.5rem 2rem
        border-radius: 16px
        max-width: 600px
        backdrop-filter: blur(24px)
        -webkit-backdrop-filter: blur(24px)
        box-shadow: 0 8px 32px rgba($primary, 0.2), 0 0 0 1px rgba($purple30, 0.1)

      &:hover
        @media (min-width: 768px)
          background-color: rgba($purple90, 0.98)
          border-color: rgba($purple50, 0.8)
          transform: translateY(-2px)
          box-shadow: 0 12px 40px rgba($primary, 0.3)

    .crane-timer
      display: flex
      flex-direction: column
      align-items: center
      gap: 0.6rem
      margin-bottom: 1rem
      color: $purple50
      font-size: 0.9rem
      font-weight: 500

      @media (min-width: 768px)
        gap: 1.2rem
        margin-bottom: 2rem
        font-size: 1.2rem

      .countdown-display, .elapsed-display
        display: flex
        justify-content: center
        align-items: center
        gap: 0.4rem
        
        @media (min-width: 768px)
          gap: 0.8rem

      .countdown-display
        font-size: 1.1rem
        font-weight: 700
        color: $purple30
        text-shadow: 0 0 6px rgba($purple30, 0.5)
        letter-spacing: 0.01em

        @media (min-width: 768px)
          font-size: 1.6rem
          text-shadow: 0 0 8px rgba($purple30, 0.6)
          letter-spacing: 0.02em

        .countdown-icon
          font-size: 1.1rem

          @media (min-width: 768px)
            font-size: 1.8rem

      .elapsed-display
        font-size: 0.8rem
        opacity: 0.8
        font-weight: 400

        @media (min-width: 768px)
          font-size: 1.1rem
          opacity: 0.9
          font-weight: 500

        .timer-icon
          font-size: 0.9rem

          @media (min-width: 768px)
            font-size: 1.3rem

    .crane-input-group
      display: flex
      flex-direction: column
      gap: 0.8rem
      align-items: center
      width: 100%

      @media (min-width: 768px)
        gap: 1.5rem

    .crane-password
      background: rgba($purple80, 0.6)
      border: 1px solid rgba($mindgarden-purple, 0.5)
      color: $purple10
      padding: 0.75rem 1rem
      font-size: 16px  // Prevents zoom on iOS
      border-radius: 8px
      outline: none
      margin: 0
      text-align: center
      transition: all 0.3s ease
      width: 100%
      max-width: 100%
      font-weight: 500
      letter-spacing: 0.01em
      backdrop-filter: blur(4px)
      -webkit-backdrop-filter: blur(4px)
      text-shadow: 0 1px 2px rgba($purple100, 0.6)

      @media (min-width: 768px)
        background: rgba($purple80, 0.15)
        border: 2px solid rgba($mindgarden-purple, 0.8)
        font-size: 1.3rem
        padding: 1rem 1.5rem
        border-radius: 12px
        max-width: 450px
        font-weight: 600
        backdrop-filter: blur(12px)
        -webkit-backdrop-filter: blur(12px)
        text-shadow: 0 1px 2px rgba($purple100, 0.8)

      &:focus
        background: rgba($purple80, 0.8)
        border-color: $purple30
        box-shadow: 0 0 0 2px rgba($purple30, 0.4)
        
        @media (min-width: 768px)
          background: rgba($purple80, 0.25)
          box-shadow: 0 0 0 3px rgba($purple30, 0.3)
          backdrop-filter: blur(16px)
          -webkit-backdrop-filter: blur(16px)

      &.crane-error
        border-color: $error-color
        background: rgba($error-color, 0.3)
        animation: craneShake 0.5s ease-in-out
        
        @media (min-width: 768px)
          background: rgba($error-color, 0.2)

      &::placeholder
        color: rgba($purple10, 0.7)

    .crane-submit
      background: $mindgarden-purple
      color: $purple10
      padding: 0.75rem 1.5rem
      border: none
      border-radius: 8px
      font-size: 1rem
      font-weight: 600
      cursor: pointer
      transition: all 0.3s ease
      display: inline-flex
      align-items: center
      justify-content: center
      gap: 0.5rem
      letter-spacing: 0.01em
      box-shadow: 0 2px 8px rgba($mindgarden-purple, 0.25)
      width: 100%
      min-height: 44px  // Ensure proper touch target size

      @media (min-width: 768px)
        padding: 1rem 2rem
        font-size: 1.2rem
        border-radius: 12px
        gap: 0.8rem
        box-shadow: 0 4px 16px rgba($mindgarden-purple, 0.3)
        width: auto
        min-height: auto

      &:hover:not(:disabled)
        @media (min-width: 768px)
          background: lighten($mindgarden-purple, 10%)
          transform: translateY(-2px)
          box-shadow: 0 6px 20px rgba($mindgarden-purple, 0.4)

      &:disabled
        opacity: 0.7
        cursor: not-allowed
        
        span
          animation: craneButtonSpin 1s linear infinite

      .crane-error-message
        color: $error-color
        margin-top: 0.8rem
        font-size: 0.85rem
        display: flex
        align-items: center
        justify-content: center
        gap: 0.4rem
        animation: craneFadeIn 0.3s ease-in
        text-align: center

        @media (min-width: 768px)
          margin-top: 1rem
          font-size: 0.9rem
          gap: 0.5rem

      .crane-hint
        color: rgba($purple10, 0.8)
        margin-top: 0.6rem
        font-size: 0.85rem
        font-weight: 400
        display: flex
        align-items: center
        justify-content: center
        gap: 0.4rem
        opacity: 0.8
        animation: craneFadeIn 0.5s ease-in 0.5s both
        text-align: center

        @media (min-width: 768px)
          margin-top: 1rem
          font-size: 1rem
          font-weight: 500
          gap: 0.6rem
          opacity: 0.9

  .crane-success-overlay
    position: absolute
    top: 50%
    left: 50%
    transform: translate(-50%, -50%)
    z-index: 4
    text-align: center
    width: 95%
    max-width: 500px

    .success-message
      background: linear-gradient(135deg, $purple30, $purple50)
      color: $purple10
      padding: 1.5rem 1.2rem
      border-radius: 12px
      font-size: 1.1rem
      font-weight: 600
      box-shadow: 0 4px 20px rgba($purple30, 0.4)
      animation: cranePulseGlow 2s infinite alternate
      text-align: center
      width: 100%

      @media (min-width: 768px)
        padding: 2rem 3rem
        border-radius: 16px
        font-size: 1.5rem
        box-shadow: 0 8px 32px rgba($purple30, 0.4)

      .success-actions
        margin-top: 1.2rem

        @media (min-width: 768px)
          margin-top: 1.5rem

        .continue-button
          background: linear-gradient(135deg, $purple50, $purple30)
          color: $purple10
          padding: 0.75rem 1.5rem
          border: none
          border-radius: 8px
          font-size: 1rem
          font-weight: 600
          cursor: pointer
          transition: all 0.3s ease
          box-shadow: 0 4px 16px rgba($purple30, 0.3)
          min-height: 44px
          width: 100%

          @media (min-width: 768px)
            padding: 0.8rem 2rem
            border-radius: 12px
            font-size: 1.1rem
            width: auto
            min-height: auto

          &:hover
            @media (min-width: 768px)
              transform: translateY(-2px)
              box-shadow: 0 6px 20px rgba($purple30, 0.4)

          &:focus
            outline: 2px solid $purple30
            outline-offset: 2px

  // Smoke canvas styling
  .crane-smoke-canvas
    position: absolute
    top: 0
    left: 0
    width: 100%
    height: 100%
    z-index: 1
    pointer-events: none

  // Shockwave explosion effect
  .shockwave
    position: absolute
    top: 50%
    left: 50%
    width: 10px
    height: 10px
    border-radius: 50%
    background: radial-gradient(circle, rgba($purple30, 0.8) 0%, rgba($purple30, 0.4) 40%, transparent 70%)
    opacity: 0
    z-index: 4
    transform: translate(-50%, -50%) scale(0)
    transition: transform 2s ease-out, opacity 2s ease-out

    &.active
      transform: translate(-50%, -50%) scale(30)
      opacity: 0.2

// Accessibility helper classes
.visually-hidden
  position: absolute !important
  width: 1px !important
  height: 1px !important
  padding: 0 !important
  margin: -1px !important
  overflow: hidden !important
  clip: rect(0, 0, 0, 0) !important
  white-space: nowrap !important
  border: 0 !important

// Crane Animation Keyframes
@keyframes craneLineDraw
  to
    stroke-dashoffset: 0

@keyframes craneIdleGlow
  0%
    filter: drop-shadow(0 0 4px rgba($purple30, 0.4))
    stroke-width: 1.5
  50%
    filter: drop-shadow(0 0 12px rgba($purple30, 0.8))
    stroke-width: 2.0
  100%
    filter: drop-shadow(0 0 4px rgba($purple30, 0.4))
    stroke-width: 1.5

@keyframes craneExplodeFly
  0%
    transform: scale(1) translate(0, 0) rotate(0deg)
    opacity: 1
  100%
    transform: scale(1.2) translate(30px, -30px) rotate(90deg)
    opacity: 0

@keyframes line-breakaway
  0%
    opacity: 1
    transform: translate(0px, 0px) rotate(0deg) scale(1)
    filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.8))
  25%
    opacity: 0.9
    transform: translate(calc(var(--tx) * 0.25), calc(var(--ty) * 0.25)) rotate(calc(var(--rot) * 0.25)) scale(1.05)
    filter: drop-shadow(0 0 10px rgba(0, 255, 255, 0.7))
  50%
    opacity: 0.7
    transform: translate(calc(var(--tx) * 0.5), calc(var(--ty) * 0.5)) rotate(calc(var(--rot) * 0.5)) scale(1.1)
    filter: drop-shadow(0 0 12px rgba(0, 255, 255, 0.6))
  75%
    opacity: 0.3
    transform: translate(calc(var(--tx) * 0.75), calc(var(--ty) * 0.75)) rotate(calc(var(--rot) * 0.75)) scale(1.2)
    filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.4))
  100%
    opacity: 0
    transform: translate(var(--tx), var(--ty)) rotate(var(--rot)) scale(1.3)
    filter: drop-shadow(0 0 4px rgba(0, 255, 255, 0.2))

@keyframes shard-fly
  0%
    opacity: 1
    transform: translate(0px, 0px) scale(1) rotate(0deg)
    filter: drop-shadow(0 0 6px rgba(0, 255, 255, 0.9))
  20%
    opacity: 0.9
    transform: translate(calc(var(--tx) * 0.2), calc(var(--ty) * 0.2)) scale(1.05) rotate(calc(var(--rot) * 0.2))
    filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.8))
  40%
    opacity: 0.7
    transform: translate(calc(var(--tx) * 0.4), calc(var(--ty) * 0.4)) scale(1.1) rotate(calc(var(--rot) * 0.4))
    filter: drop-shadow(0 0 10px rgba(0, 255, 255, 0.7))
  60%
    opacity: 0.5
    transform: translate(calc(var(--tx) * 0.6), calc(var(--ty) * 0.6)) scale(1.15) rotate(calc(var(--rot) * 0.6))
    filter: drop-shadow(0 0 8px rgba(0, 255, 255, 0.5))
  80%
    opacity: 0.2
    transform: translate(calc(var(--tx) * 0.8), calc(var(--ty) * 0.8)) scale(1.25) rotate(calc(var(--rot) * 0.8))
    filter: drop-shadow(0 0 6px rgba(0, 255, 255, 0.3))
  100%
    opacity: 0
    transform: translate(var(--tx), var(--ty)) scale(1.4) rotate(var(--rot))
    filter: drop-shadow(0 0 2px rgba(0, 255, 255, 0.1))

@keyframes craneShake
  0%, 100%
    transform: translateX(0)
  25%
    transform: translateX(-5px)
  75%
    transform: translateX(5px)

@keyframes craneFadeIn
  from
    opacity: 0
    transform: translateY(10px)
  to
    opacity: 1
    transform: translateY(0)

@keyframes craneButtonSpin
  from
    transform: rotate(0deg)
  to
    transform: rotate(360deg)

@keyframes cranePulseGlow
  from
    box-shadow: 0 8px 32px rgba($purple30, 0.4)
  to
    box-shadow: 0 8px 32px rgba($purple30, 0.8), 0 0 60px rgba($purple30, 0.3)

@keyframes craneUIFadeIn
  from
    opacity: 0
    transform: translateX(-50%) translateY(20px)
  to
    opacity: 1
    transform: translateX(-50%) translateY(0)

// Mobile-specific layout for crane gate - only apply on actual mobile screens
@media (max-width: 768px)
  .crane-gate-container.is-mobile
    .crane-svg-container
      // Position the smaller crane at the bottom, clear of input group
      align-items: flex-end !important
      padding: 0 0.5rem 2rem !important
      
    .crane-svg
      align-items: flex-end !important
      padding-bottom: 0 !important
      // Add top margin to push crane further down from input group
      margin-top: 45vh !important
      
      svg
        max-width: 400px !important
        //width:50% !important
        // Allow flexible sizing on mobile
        //max-width: none
        //width: 100%
        height: auto
        
      // Enhanced animations for mobile - add SASS animations to SVG internal animations
      &.stage-drawing .line
        // Let SVG handle stroke color and basic animation
        // Add SASS animation for enhanced drawing effect
        animation: craneLineDraw 6s forwards
        filter: drop-shadow(0 0 4px rgba($purple30, 0.5))
        
      &.stage-idle .line
        // Let SVG handle stroke color and basic pulse
        // Add SASS animation for enhanced glow effect
        animation: craneIdleGlow 2s infinite alternate
        filter: drop-shadow(0 0 6px rgba($purple30, 0.6))
        
      &.stage-explode .line
        animation: line-breakaway 1.2s ease-in-out forwards
        
      &.stage-explode .shard
        animation: shard-fly 1.2s ease-out forwards
      
    .crane-ui-overlay
      top: 8vh !important
      left: 50% !important
      transform: translateX(-50%) !important
      width: 95vw !important
      max-width: 95vw !important
      padding: 0 1rem !important
      
    .crane-interface-card
      background-color: rgba($purple90, 0.15) !important
      border: 2px solid rgba($purple50, 0.6) !important
      backdrop-filter: blur(20px) !important
      -webkit-backdrop-filter: blur(20px) !important
      width: 100% !important
      max-width: 100% !important
      padding: 1rem !important

// Global background transition class
.cathedral-bg-transition
  transition: background-color 1.5s ease-out !important

// Enhanced title for success state
.enhanced-title
  background: linear-gradient(45deg, $purple30, $purple50, $purple30)
  background-size: 200% 200%
  background-clip: text
  -webkit-background-clip: text
  -webkit-text-fill-color: transparent
  animation: titleShimmer 3s ease-in-out infinite

@keyframes titleShimmer
  0%, 100%
    background-position: 0% 50%
  50%
    background-position: 100% 50%